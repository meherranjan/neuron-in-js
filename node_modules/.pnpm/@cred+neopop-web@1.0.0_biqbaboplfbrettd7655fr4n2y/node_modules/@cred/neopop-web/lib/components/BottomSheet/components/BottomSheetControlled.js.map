{"version":3,"file":"BottomSheetControlled.js","sources":["../../../../src/components/BottomSheet/components/BottomSheetControlled.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { useSpring } from '@react-spring/web';\nimport { Handler, useDrag, rubberbandIfOutOfBounds } from '@use-gesture/react';\nimport { Portal } from 'react-portal';\nimport useDelayMount from '@hooks/useDelayMount';\nimport useClientHeight from '@hooks/useClientHeight';\nimport { UseBottomSheetMechanicsArgs, Prop } from '../types';\n\nimport { Wraper, Overlay, Sheet, GapFiller, Content, Card, Notch, CardCustom } from '../styles';\n\nconst twoThirdOf = (number: number) => (number * 2) / 3;\n\nexport const useBottomSheetMechanics = ({\n    open,\n    handleClose,\n    onBeforeClose,\n    onCloseEnd,\n    blocking,\n    onOpenEnd,\n}: UseBottomSheetMechanicsArgs) => {\n    const mounted = useDelayMount(open);\n    const [{ y, opacity, scaleY }, api] = useSpring(() => ({\n        y: '100%',\n        scaleY: 1,\n        opacity: 0,\n        config: { tension: 180, friction: 25 },\n    }));\n    const [cardRef, sheetHeight] = useClientHeight<HTMLDivElement>();\n    const preventScrollRef = useRef(false);\n    const closeInProgressRef = useRef(false);\n\n    const requestCloseBottomSheet = () => {\n        if (closeInProgressRef.current) {\n            return;\n        }\n        closeInProgressRef.current = true;\n        handleClose();\n    };\n\n    const springApiSet = async ({ onRest = () => {}, ...option }: any) =>\n        new Promise((resolve) => {\n            api.start({\n                ...option,\n                onRest: (...args) => {\n                    resolve(args);\n                    onRest?.(...args);\n                },\n            });\n        });\n\n    const closeBottomSheet = () => {\n        if (onBeforeClose instanceof Function) {\n            onBeforeClose();\n        }\n        closeInProgressRef.current = true;\n        springApiSet({\n            opacity: 0,\n            y: sheetHeight ? `${sheetHeight + 200}px` : '115%',\n            onRest: (...args: any[]) => {\n                const event = args[0];\n                if (event?.finished && !event?.cancelled) {\n                    onCloseEnd();\n                }\n            },\n        });\n    };\n\n    useEffect(() => {\n        (async () => {\n            if (mounted) {\n                await springApiSet({\n                    opacity: 1,\n                    y: '0px',\n                });\n                if (onOpenEnd instanceof Function) {\n                    onOpenEnd();\n                }\n                closeInProgressRef.current = false;\n            } else {\n                closeBottomSheet();\n            }\n        })();\n    }, [mounted]);\n\n    useEffect(() => {\n        const element = cardRef.ref.current;\n        const preventScrolling = (e: Event) => {\n            if (preventScrollRef.current) {\n                e.preventDefault();\n            }\n        };\n\n        element.addEventListener('scroll', preventScrolling);\n        element.addEventListener('touchmove', preventScrolling);\n\n        return () => {\n            element.removeEventListener('scroll', preventScrolling);\n            element.removeEventListener('touchmove', preventScrolling);\n        };\n    }, [cardRef.ref.current]);\n\n    const handleDrag: Handler<'drag'> = ({\n        args: [{ closeOnTap = false, contentSheet = false } = {}] = [],\n        cancel,\n        active,\n        tap,\n        velocity: [, vy = 0],\n        movement: [, my],\n        direction: [, dy],\n    }) => {\n        if (closeInProgressRef.current) {\n            return;\n        }\n\n        if (tap && closeOnTap) {\n            requestCloseBottomSheet();\n            return;\n        }\n\n        if (contentSheet) {\n            const elem = cardRef.ref.current;\n            preventScrollRef.current = dy > 0 && elem.scrollTop === 0;\n        }\n\n        // it's not the correct Physics formula just a measure of user intent\n        const predictedDistance = my * vy;\n        if (!blocking && predictedDistance >= twoThirdOf(sheetHeight)) {\n            cancel();\n            requestCloseBottomSheet();\n            return;\n        }\n\n        const yValue = rubberbandIfOutOfBounds(my, -1, sheetHeight + 100, 0.12);\n        springApiSet({\n            y: active ? `${yValue}px` : '0px',\n            immediate: active,\n            scaleY: active && yValue < 0 ? Math.ceil(Math.abs(yValue)) : 1,\n        });\n    };\n\n    const bind = useDrag(handleDrag, {\n        filterTaps: true,\n    });\n\n    return {\n        requestCloseBottomSheet,\n        opacity,\n        y,\n        bind,\n        cardRef,\n        scaleY,\n    };\n};\n\nconst BottomSheetControlled = ({\n    children,\n    node,\n    handleClose,\n    blocking = false,\n    onCloseEnd,\n    onBeforeClose,\n    open,\n    maxHeight = '85%',\n    sheetStyle,\n    sheetPlunkColor,\n    overlayColor,\n    ...props\n}: Prop) => {\n    const { requestCloseBottomSheet, opacity, y, bind, cardRef, scaleY } = useBottomSheetMechanics({\n        open,\n        handleClose,\n        onBeforeClose,\n        onCloseEnd,\n        blocking,\n    });\n\n    return (\n        <Portal node={node || document.body}>\n            <Wraper {...props}>\n                <Overlay\n                    onKeyDown={(event) => {\n                        if (event.key === 'Escape' && !blocking) {\n                            // Always stop propagation, to avoid weirdness for bottom sheets inside other bottom sheets\n                            event.stopPropagation();\n                            requestCloseBottomSheet();\n                        }\n                    }}\n                    style={{ opacity, backgroundColor: overlayColor }}\n                    {...bind({ closeOnTap: !blocking })}\n                />\n                <Card\n                    $sheetShadowColor={sheetPlunkColor}\n                    $maxHeight={maxHeight}\n                    style={{ ...sheetStyle, y }}\n                >\n                    <Notch {...bind()} />\n                    <Sheet {...cardRef} {...bind({ contentSheet: true })}>\n                        <Content>{children}</Content>\n                    </Sheet>\n                </Card>\n                <GapFiller style={{ scaleY, opacity }} />\n            </Wraper>\n        </Portal>\n    );\n};\n\nexport const BottomSheetControlledCustom = ({\n    children,\n    node,\n    handleClose,\n    blocking = false,\n    onCloseEnd,\n    onBeforeClose,\n    open,\n    maxHeight = '85%',\n    sheetStyle,\n    sheetPlunkColor,\n    overlayColor,\n    shouldShowNotch = true,\n    shouldShowOverlay = true,\n    ...props\n}: Prop) => {\n    const { requestCloseBottomSheet, opacity, y, bind, cardRef } = useBottomSheetMechanics({\n        open,\n        handleClose,\n        onBeforeClose,\n        onCloseEnd,\n        blocking,\n    });\n\n    return (\n        <Portal node={node || document.body}>\n            <Wraper {...props}>\n                {shouldShowOverlay ? (\n                    <Overlay\n                        onKeyDown={(event) => {\n                            if (event.key === 'Escape' && !blocking) {\n                                // Always stop propagation, to avoid weirdness for bottom sheets inside other bottom sheets\n                                event.stopPropagation();\n                                requestCloseBottomSheet();\n                            }\n                        }}\n                        style={{ opacity, backgroundColor: overlayColor }}\n                        {...bind({ closeOnTap: !blocking })}\n                    />\n                ) : null}\n                <CardCustom $maxHeight={maxHeight} style={{ ...sheetStyle, y }}>\n                    {shouldShowNotch ? <Notch {...bind()} /> : null}\n                    <Sheet {...cardRef} {...bind({ contentSheet: true })}>\n                        {children}\n                    </Sheet>\n                </CardCustom>\n            </Wraper>\n        </Portal>\n    );\n};\n\nexport default BottomSheetControlled;\n"],"names":["twoThirdOf","number","useBottomSheetMechanics","open","handleClose","onBeforeClose","onCloseEnd","blocking","onOpenEnd","mounted","useDelayMount","useSpring","y","scaleY","opacity","config","tension","friction","_slicedToArray","api","useClientHeight","cardRef","sheetHeight","preventScrollRef","useRef","closeInProgressRef","requestCloseBottomSheet","current","springApiSet","_asyncToGenerator","_regeneratorRuntime","onRest","option","_objectWithoutProperties","Promise","resolve","start","_objectSpread","args","closeBottomSheet","Function","event","finished","cancelled","useEffect","element","ref","preventScrolling","e","preventDefault","addEventListener","removeEventListener","handleDrag","closeOnTap","contentSheet","cancel","active","tap","velocity","vy","movement","my","direction","dy","elem","scrollTop","predictedDistance","yValue","rubberbandIfOutOfBounds","immediate","Math","ceil","abs","bind","useDrag","filterTaps","BottomSheetControlled","children","node","maxHeight","sheetStyle","sheetPlunkColor","overlayColor","props","React","Portal","document","body","Wraper","Overlay","_extends","key","stopPropagation","backgroundColor","Card","Notch","Sheet","Content","GapFiller","BottomSheetControlledCustom","shouldShowNotch","shouldShowOverlay","CardCustom"],"mappings":"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"}