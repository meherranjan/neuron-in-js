{"version":3,"file":"use-gesture-core.esm.js","sources":["../../../../../node_modules/@use-gesture/core/dist/use-gesture-core.esm.js"],"sourcesContent":["import { S as SUPPORT, C as ConfigResolverMap, _ as _objectSpread2, a as _defineProperty, t as toDomEventType, i as isTouch, b as touchIds, E as EngineMap, c as chain, p as parseProp, d as toHandlerProp } from './actions-1416bf77.esm.js';\nimport './maths-b2a210f4.esm.js';\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nconst sharedConfigResolver = {\n  target(value) {\n    if (value) {\n      return () => 'current' in value ? value.current : value;\n    }\n\n    return undefined;\n  },\n\n  enabled(value = true) {\n    return value;\n  },\n\n  window(value = SUPPORT.isBrowser ? window : undefined) {\n    return value;\n  },\n\n  eventOptions({\n    passive = true,\n    capture = false\n  } = {}) {\n    return {\n      passive,\n      capture\n    };\n  },\n\n  transform(value) {\n    return value;\n  }\n\n};\n\nconst _excluded = [\"target\", \"eventOptions\", \"window\", \"enabled\", \"transform\"];\nfunction resolveWith(config = {}, resolvers) {\n  const result = {};\n\n  for (const [key, resolver] of Object.entries(resolvers)) {\n    switch (typeof resolver) {\n      case 'function':\n        if (process.env.NODE_ENV === 'development') {\n          const r = resolver.call(result, config[key], key, config);\n          if (!Number.isNaN(r)) result[key] = r;\n        } else {\n          result[key] = resolver.call(result, config[key], key, config);\n        }\n\n        break;\n\n      case 'object':\n        result[key] = resolveWith(config[key], resolver);\n        break;\n\n      case 'boolean':\n        if (resolver) result[key] = config[key];\n        break;\n    }\n  }\n\n  return result;\n}\nfunction parse(config, gestureKey) {\n  const _ref = config,\n        {\n    target,\n    eventOptions,\n    window,\n    enabled,\n    transform\n  } = _ref,\n        rest = _objectWithoutProperties(_ref, _excluded);\n\n  const _config = {\n    shared: resolveWith({\n      target,\n      eventOptions,\n      window,\n      enabled,\n      transform\n    }, sharedConfigResolver)\n  };\n\n  if (gestureKey) {\n    const resolver = ConfigResolverMap.get(gestureKey);\n    _config[gestureKey] = resolveWith(_objectSpread2({\n      shared: _config.shared\n    }, rest), resolver);\n  } else {\n    for (const key in rest) {\n      const resolver = ConfigResolverMap.get(key);\n\n      if (resolver) {\n        _config[key] = resolveWith(_objectSpread2({\n          shared: _config.shared\n        }, rest[key]), resolver);\n      } else if (process.env.NODE_ENV === 'development') {\n        if (!['drag', 'pinch', 'scroll', 'wheel', 'move', 'hover'].includes(key)) {\n          if (key === 'domTarget') {\n            throw Error(`[@use-gesture]: \\`domTarget\\` option has been renamed to \\`target\\`.`);\n          }\n\n          console.warn(`[@use-gesture]: Unknown config key \\`${key}\\` was used. Please read the documentation for further information.`);\n        }\n      }\n    }\n  }\n\n  return _config;\n}\n\nclass EventStore {\n  constructor(ctrl, gestureKey) {\n    _defineProperty(this, \"_listeners\", new Set());\n\n    this._ctrl = ctrl;\n    this._gestureKey = gestureKey;\n  }\n\n  add(element, device, action, handler, options) {\n    const listeners = this._listeners;\n    const type = toDomEventType(device, action);\n\n    const _options = this._gestureKey ? this._ctrl.config[this._gestureKey].eventOptions : {};\n\n    const eventOptions = _objectSpread2(_objectSpread2({}, _options), options);\n\n    element.addEventListener(type, handler, eventOptions);\n\n    const remove = () => {\n      element.removeEventListener(type, handler, eventOptions);\n      listeners.delete(remove);\n    };\n\n    listeners.add(remove);\n    return remove;\n  }\n\n  clean() {\n    this._listeners.forEach(remove => remove());\n\n    this._listeners.clear();\n  }\n\n}\n\nclass TimeoutStore {\n  constructor() {\n    _defineProperty(this, \"_timeouts\", new Map());\n  }\n\n  add(key, callback, ms = 140, ...args) {\n    this.remove(key);\n\n    this._timeouts.set(key, window.setTimeout(callback, ms, ...args));\n  }\n\n  remove(key) {\n    const timeout = this._timeouts.get(key);\n\n    if (timeout) window.clearTimeout(timeout);\n  }\n\n  clean() {\n    this._timeouts.forEach(timeout => void window.clearTimeout(timeout));\n\n    this._timeouts.clear();\n  }\n\n}\n\nclass Controller {\n  constructor(handlers) {\n    _defineProperty(this, \"gestures\", new Set());\n\n    _defineProperty(this, \"_targetEventStore\", new EventStore(this));\n\n    _defineProperty(this, \"gestureEventStores\", {});\n\n    _defineProperty(this, \"gestureTimeoutStores\", {});\n\n    _defineProperty(this, \"handlers\", {});\n\n    _defineProperty(this, \"config\", {});\n\n    _defineProperty(this, \"pointerIds\", new Set());\n\n    _defineProperty(this, \"touchIds\", new Set());\n\n    _defineProperty(this, \"state\", {\n      shared: {\n        shiftKey: false,\n        metaKey: false,\n        ctrlKey: false,\n        altKey: false\n      }\n    });\n\n    resolveGestures(this, handlers);\n  }\n\n  setEventIds(event) {\n    if (isTouch(event)) {\n      this.touchIds = new Set(touchIds(event));\n      return this.touchIds;\n    } else if ('pointerId' in event) {\n      if (event.type === 'pointerup' || event.type === 'pointercancel') this.pointerIds.delete(event.pointerId);else if (event.type === 'pointerdown') this.pointerIds.add(event.pointerId);\n      return this.pointerIds;\n    }\n  }\n\n  applyHandlers(handlers, nativeHandlers) {\n    this.handlers = handlers;\n    this.nativeHandlers = nativeHandlers;\n  }\n\n  applyConfig(config, gestureKey) {\n    this.config = parse(config, gestureKey);\n  }\n\n  clean() {\n    this._targetEventStore.clean();\n\n    for (const key of this.gestures) {\n      this.gestureEventStores[key].clean();\n      this.gestureTimeoutStores[key].clean();\n    }\n  }\n\n  effect() {\n    if (this.config.shared.target) this.bind();\n    return () => this._targetEventStore.clean();\n  }\n\n  bind(...args) {\n    const sharedConfig = this.config.shared;\n    const props = {};\n    let target;\n\n    if (sharedConfig.target) {\n      target = sharedConfig.target();\n      if (!target) return;\n    }\n\n    if (sharedConfig.enabled) {\n      for (const gestureKey of this.gestures) {\n        const gestureConfig = this.config[gestureKey];\n        const bindFunction = bindToProps(props, gestureConfig.eventOptions, !!target);\n\n        if (gestureConfig.enabled) {\n          const Engine = EngineMap.get(gestureKey);\n          new Engine(this, args, gestureKey).bind(bindFunction);\n        }\n      }\n\n      const nativeBindFunction = bindToProps(props, sharedConfig.eventOptions, !!target);\n\n      for (const eventKey in this.nativeHandlers) {\n        nativeBindFunction(eventKey, '', event => this.nativeHandlers[eventKey](_objectSpread2(_objectSpread2({}, this.state.shared), {}, {\n          event,\n          args\n        })), undefined, true);\n      }\n    }\n\n    for (const handlerProp in props) {\n      props[handlerProp] = chain(...props[handlerProp]);\n    }\n\n    if (!target) return props;\n\n    for (const handlerProp in props) {\n      const {\n        device,\n        capture,\n        passive\n      } = parseProp(handlerProp);\n\n      this._targetEventStore.add(target, device, '', props[handlerProp], {\n        capture,\n        passive\n      });\n    }\n  }\n\n}\n\nfunction setupGesture(ctrl, gestureKey) {\n  ctrl.gestures.add(gestureKey);\n  ctrl.gestureEventStores[gestureKey] = new EventStore(ctrl, gestureKey);\n  ctrl.gestureTimeoutStores[gestureKey] = new TimeoutStore();\n}\n\nfunction resolveGestures(ctrl, internalHandlers) {\n  if (internalHandlers.drag) setupGesture(ctrl, 'drag');\n  if (internalHandlers.wheel) setupGesture(ctrl, 'wheel');\n  if (internalHandlers.scroll) setupGesture(ctrl, 'scroll');\n  if (internalHandlers.move) setupGesture(ctrl, 'move');\n  if (internalHandlers.pinch) setupGesture(ctrl, 'pinch');\n  if (internalHandlers.hover) setupGesture(ctrl, 'hover');\n}\n\nconst bindToProps = (props, eventOptions, withPassiveOption) => (device, action, handler, options = {}, isNative = false) => {\n  var _options$capture, _options$passive;\n\n  const capture = (_options$capture = options.capture) !== null && _options$capture !== void 0 ? _options$capture : eventOptions.capture;\n  const passive = (_options$passive = options.passive) !== null && _options$passive !== void 0 ? _options$passive : eventOptions.passive;\n  let handlerProp = isNative ? device : toHandlerProp(device, action, capture);\n  if (withPassiveOption && passive) handlerProp += 'Passive';\n  props[handlerProp] = props[handlerProp] || [];\n  props[handlerProp].push(handler);\n};\n\nconst RE_NOT_NATIVE = /^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;\n\nfunction sortHandlers(_handlers) {\n  const native = {};\n  const handlers = {};\n  const actions = new Set();\n\n  for (let key in _handlers) {\n    if (RE_NOT_NATIVE.test(key)) {\n      actions.add(RegExp.lastMatch);\n      handlers[key] = _handlers[key];\n    } else {\n      native[key] = _handlers[key];\n    }\n  }\n\n  return [handlers, native, actions];\n}\n\nfunction registerGesture(actions, handlers, handlerKey, key, internalHandlers, config) {\n  if (!actions.has(handlerKey)) return;\n\n  if (!EngineMap.has(key)) {\n    if (process.env.NODE_ENV === 'development') {\n      console.warn(`[@use-gesture]: You've created a custom handler that that uses the \\`${key}\\` gesture but isn't properly configured.\\n\\nPlease add \\`${key}Action\\` when creating your handler.`);\n    }\n\n    return;\n  }\n\n  const startKey = handlerKey + 'Start';\n  const endKey = handlerKey + 'End';\n\n  const fn = state => {\n    let memo = undefined;\n    if (state.first && startKey in handlers) handlers[startKey](state);\n    if (handlerKey in handlers) memo = handlers[handlerKey](state);\n    if (state.last && endKey in handlers) handlers[endKey](state);\n    return memo;\n  };\n\n  internalHandlers[key] = fn;\n  config[key] = config[key] || {};\n}\n\nfunction parseMergedHandlers(mergedHandlers, mergedConfig) {\n  const [handlers, nativeHandlers, actions] = sortHandlers(mergedHandlers);\n  const internalHandlers = {};\n  registerGesture(actions, handlers, 'onDrag', 'drag', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onWheel', 'wheel', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onScroll', 'scroll', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onPinch', 'pinch', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onMove', 'move', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onHover', 'hover', internalHandlers, mergedConfig);\n  return {\n    handlers: internalHandlers,\n    config: mergedConfig,\n    nativeHandlers\n  };\n}\n\nexport { Controller, parseMergedHandlers };\n"],"names":["_objectWithoutPropertiesLoose","source","excluded","target","sourceKeys","Object","keys","key","i","length","indexOf","_objectWithoutProperties","getOwnPropertySymbols","sourceSymbolKeys","prototype","propertyIsEnumerable","call","sharedConfigResolver","value","current","undefined","enabled","window","SUPPORT","isBrowser","eventOptions","passive","capture","transform","_excluded","resolveWith","config","resolvers","result","entries","resolver","process","env","NODE_ENV","r","Number","isNaN","parse","gestureKey","_ref","rest","_config","shared","ConfigResolverMap","get","_objectSpread2","includes","Error","console","warn","EventStore","ctrl","_defineProperty","Set","_ctrl","_gestureKey","element","device","action","handler","options","listeners","_listeners","type","toDomEventType","_options","addEventListener","remove","removeEventListener","add","forEach","clear","TimeoutStore","Map","callback","ms","args","_timeouts","set","setTimeout","timeout","clearTimeout","Controller","handlers","shiftKey","metaKey","ctrlKey","altKey","resolveGestures","event","isTouch","touchIds","pointerIds","pointerId","nativeHandlers","_targetEventStore","clean","gestures","gestureEventStores","gestureTimeoutStores","bind","sharedConfig","props","gestureConfig","bindFunction","bindToProps","Engine","EngineMap","nativeBindFunction","eventKey","state","handlerProp","chain","parseProp","setupGesture","internalHandlers","drag","wheel","scroll","move","pinch","hover","withPassiveOption","isNative","_options$capture","_options$passive","toHandlerProp","push"],"mappings":"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"}